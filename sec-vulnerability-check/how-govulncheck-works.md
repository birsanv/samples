# How `govulncheck` Finds Vulnerabilities

A comprehensive guide to understanding how Go's vulnerability scanner works under the hood.

## ğŸ” **Overview**

`govulncheck` is Go's official vulnerability scanner that identifies security issues in your Go code and dependencies. It works by matching your code's dependencies against a curated vulnerability database.

## ğŸ—„ï¸ **1. The Vulnerability Database (Source of Truth)**

```
Go Vulnerability Database: https://pkg.go.dev/vuln/
â”œâ”€â”€ CVE Reports
â”œâ”€â”€ Go Security Team Reports  
â”œâ”€â”€ Community Reports
â””â”€â”€ Automated Analysis
```

### **Database Contents:**
- **Official CVEs**: Common Vulnerabilities and Exposures from industry databases
- **Go-Specific Issues**: Security problems identified by the Go security team
- **Version Mapping**: Each vulnerability is precisely mapped to affected package versions
- **Fix Information**: Details on which versions resolve each issue

### **Vulnerability ID Format:**
```
GO-YYYY-NNNN
â”‚   â”‚    â”‚
â”‚   â”‚    â””â”€â”€ Sequential number
â”‚   â””â”€â”€â”€â”€â”€ Year discovered
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€ Go prefix

Example: GO-2025-3595
```

## ğŸ”§ **2. Three Scan Modes (Different Detection Methods)**

### **ğŸŸ¦ Module Scan (`-scan=module`)** - Recommended Default
```bash
# How it works:
1. Reads go.mod and go.sum files
2. Builds complete dependency tree (including transitive dependencies)
3. Matches each dependency version against vulnerability database
4. Reports ALL vulnerabilities in dependencies (regardless of actual usage)
```

**Advantages:**
- âœ… Fast execution
- âœ… Comprehensive coverage
- âœ… Perfect for CI/CD pipelines
- âœ… No false negatives

**Use Cases:**
- Daily/weekly security checks
- CI/CD pipeline integration
- Quick dependency audits

### **ğŸŸ¨ Symbol Scan (Default behavior)** - More Precise
```bash
# How it works:
1. Builds Abstract Syntax Tree (AST) of your entire codebase
2. Traces function calls and import paths
3. Determines which vulnerable code paths are actually reachable
4. Only reports vulnerabilities in code you actively USE
```

**Advantages:**
- âœ… More accurate (fewer false positives)
- âœ… Shows actual risk to your application
- âœ… Detailed call path analysis

**Disadvantages:**
- âŒ Slower execution
- âŒ Can fail on complex dependency graphs
- âŒ May miss dynamically loaded code

### **ğŸŸ© Binary Scan (`-mode=binary`)** - Production Analysis
```bash
# How it works:
1. Analyzes the compiled binary
2. Examines actually linked code
3. Most accurate representation of deployed application
4. Shows vulnerabilities in production artifact
```

**Best For:**
- Production deployment validation
- Final security verification
- Compliance audits

## ğŸ”„ **3. Vulnerability Detection Process**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Your Code     â”‚â”€â”€â”€â–¶â”‚  govulncheck    â”‚â”€â”€â”€â–¶â”‚ Vulnerability   â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚   Database      â”‚
â”‚ â€¢ go.mod        â”‚    â”‚ 1. Parse deps   â”‚    â”‚                 â”‚
â”‚ â€¢ go.sum        â”‚    â”‚ 2. Build graph  â”‚    â”‚ â€¢ CVEs          â”‚
â”‚ â€¢ source code   â”‚    â”‚ 3. Query DB     â”‚    â”‚ â€¢ Go Security   â”‚
â”‚                 â”‚    â”‚ 4. Match vers   â”‚    â”‚ â€¢ Version maps  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **Step-by-Step Process:**

1. **Dependency Discovery**
   ```bash
   # govulncheck reads:
   go.mod    # Direct dependencies
   go.sum    # Dependency versions and checksums
   vendor/   # Vendored dependencies (if present)
   ```

2. **Dependency Graph Building**
   ```bash
   # Creates complete tree:
   your-project
   â”œâ”€â”€ golang.org/x/net@v0.36.0
   â”‚   â”œâ”€â”€ golang.org/x/sys@v0.1.0
   â”‚   â””â”€â”€ golang.org/x/text@v0.3.0
   â””â”€â”€ k8s.io/client-go@v0.32.3
       â”œâ”€â”€ golang.org/x/oauth2@v0.30.0
       â””â”€â”€ ... (hundreds more)
   ```

3. **Database Querying**
   ```bash
   # For each dependency:
   Query: "vulnerabilities in golang.org/x/net@v0.36.0"
   Response: [GO-2025-3595, ...] or []
   ```

4. **Result Classification**
   ```bash
   # Categorizes findings:
   Standard Library:     vulnerabilities in stdlib@go1.23.0
   Third-party Deps:     vulnerabilities in external packages
   ```

## ğŸ” **4. Standard Library vs Dependencies**

### **ğŸ”´ Standard Library Vulnerabilities**

```bash
# Detection Process:
1. govulncheck identifies your Go version: go1.23.0
2. Queries database: "vulnerabilities in stdlib@go1.23.0"
3. Returns ALL unfixed security issues in that Go runtime
4. These are ALWAYS reported (every Go program uses stdlib)
```

**Example Result:**
```
Vulnerability: GO-2025-3751
Source: Standard library (stdlib@go1.23.0)
Issue: Sensitive headers not cleared on cross-origin redirect
Component: net/http
Fix: Update to Go 1.23.10+
```

### **ğŸŸ¡ Third-party Dependencies**

```bash
# Detection Process:
1. Parses go.mod for external dependencies
2. For each dependency: checks specific version against database
3. Reports vulnerabilities in that exact version
4. Provides upgrade path to fixed version
```

**Example Result:**
```
Vulnerability: GO-2025-3595  
Source: golang.org/x/net@v0.36.0
Issue: Input neutralization in web page generation
Fix: Update to golang.org/x/net@v0.38.0+
```

## ğŸ“Š **5. Real Example: some Branch Scan**

### **What Happened:**

```bash
# 1. govulncheck read your go.mod:
module github.com/stolostron/cluster-backup-operator
go 1.23
require (
    golang.org/x/net v0.36.0  # â† Vulnerable version
    ...
)

# 2. Database query:
Query: "vulnerabilities in golang.org/x/net@v0.36.0"
Response: [GO-2025-3595]

# 3. Vulnerability details:
GO-2025-3595:
  Title: "Incorrect Neutralization of Input During Web Page Generation"
  Affected: golang.org/x/net@v0.36.0
  Fixed: golang.org/x/net@v0.38.0
  Severity: Medium

# 4. Classification:
Source: Third-party dependency (not Go standard library)
Action: Update golang.org/x/net to v0.38.0+
```

### **Why Main Branch is Clean:**

```bash
# Main branch has:
golang.org/x/net v0.38.0+  # â† Fixed version

# Result:
Query: "vulnerabilities in golang.org/x/net@v0.38.0"
Response: []  # No vulnerabilities found
```

## ğŸ”„ **6. Database Update Process**

### **Continuous Monitoring:**
```bash
# Go Security Team monitors:
â”œâ”€â”€ CVE Databases (NVD, MITRE)
â”œâ”€â”€ Security Mailing Lists
â”œâ”€â”€ GitHub Security Advisories  
â”œâ”€â”€ Bug Reports and Issues
â””â”€â”€ Automated Scanning Tools
```

### **Vulnerability Lifecycle:**
```bash
1. Security Issue Discovered
   â†“
2. Analysis & Verification
   â†“  
3. Go-specific Impact Assessment
   â†“
4. Vulnerability Record Creation (GO-YYYY-NNNN)
   â†“
5. Version Mapping & Fix Verification
   â†“
6. Database Publication
   â†“
7. govulncheck Integration (automatic)
```

### **Database Freshness:**
- **Real-time**: govulncheck fetches latest data on each run
- **No caching**: Always queries current vulnerability state
- **Immediate updates**: New vulnerabilities appear in scans immediately

## ğŸ¯ **7. Why Module Scan Works Best**

### **For Your Use Case:**

```bash
âœ… Advantages:
â€¢ Fast execution (seconds vs minutes)
â€¢ Comprehensive coverage (catches everything)
â€¢ Reliable (no complex analysis failures)
â€¢ CI/CD friendly (predictable performance)
â€¢ No false negatives (better safe than sorry)

âŒ Symbol Scan Issues:
â€¢ Complex dependency analysis can fail
â€¢ Internal errors with certain package combinations
â€¢ Slower execution (impacts CI/CD pipelines)
â€¢ May miss dynamically loaded vulnerabilities
```

## ğŸ› ï¸ **8. Practical Insights**

### **Version Matching is Exact:**
```bash
# These are different in the database:
golang.org/x/net@v0.36.0  â† Has GO-2025-3595
golang.org/x/net@v0.37.0  â† Still has GO-2025-3595  
golang.org/x/net@v0.38.0  â† Fixed (no vulnerabilities)
```

### **Transitive Dependencies:**
```bash
# govulncheck scans ALL dependencies:
Your direct deps:     k8s.io/client-go
Their dependencies:   golang.org/x/net (vulnerable)
Result:              Vulnerability reported even though 
                     you didn't directly import x/net
```

### **Go Version Impact:**
```bash
# Standard library vulnerabilities depend on Go version:
go1.23.0  â† Has 9 stdlib vulnerabilities
go1.23.10 â† Most vulnerabilities fixed
go1.24.0  â† Even more fixes (when released)
```

## ğŸ”— **9. Additional Resources**

- **Official Documentation**: https://pkg.go.dev/golang.org/x/vuln/cmd/govulncheck
- **Vulnerability Database**: https://pkg.go.dev/vuln/
- **Go Security Policy**: https://go.dev/security/
- **CVE Database**: https://cve.mitre.org/
- **GitHub Security**: https://github.com/advisories

## ğŸ’¡ **Key Takeaways**

1. **Simple Concept**: govulncheck is essentially sophisticated version matching
2. **Database-Driven**: All detection relies on the curated Go vulnerability database
3. **Version-Specific**: Exact version numbers matter for vulnerability detection
4. **Comprehensive**: Scans your entire dependency tree, including transitive deps
5. **Real-Time**: Always uses the latest vulnerability information
6. **Actionable**: Provides clear upgrade paths to fix issues

This makes `govulncheck` a reliable, straightforward tool for maintaining Go application security! ğŸ›¡ï¸ 